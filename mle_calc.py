# -*- coding: utf-8 -*-
"""
Created on Sat Oct 10 14:51:24 2020

@author: Akshay Bhatia
"""


import numpy as np
from sympy import symbols
from scipy.optimize import fsolve

W = np.array([0, 0, 253, 490, 714, 992, 1236, 1472, 1739, 1923, 2290, 2541, 2844, 3076, 3245, 3571, 3825, 4219, 4349, 4672, 4599, 5024, 5540, 5855, 5999, 6531, 6769, 7246, 7335, 7723, 7959, 8377, 8987, 9200, 9475, 10175, 10272, 10363, 10995, 11317, 11672, 12014, 12382, 12486, 12667, 13218, 13431, 13687, 13871, 14482, 14960, 15142, 15483, 15841, 15804, 16345, 16493, 17002, 17758, 18385, 18788, 19471, 19617, 20087, 20535, 21163, 22026, 22091, 23090, 23441, 23645, 23866, 24625, 25074, 25765, 25767, 26500, 27300, 27610, 28061, 28277, 28847, 29431, 29849, 30286, 31260, 31647, 32040, 32749, 33046, 33809, 33892, 35019, 35309, 35793, 36419, 36899, 37719, 37994, 39191, 39704, 40267, 40797, 41161, 42634, 43658, 44439, 44904, 45084, 45961, 47014, 48104, 48862, 48970, 49536, 50567, 51413, 52022, 52773, 53472, 54310, 54987, 55929, 55786, 57084, 57625, 58611, 59418, 60176, 60964, 61565, 62330, 63399, 64347, 65641, 65548, 66377, 66910, 68178, 69064, 70473, 71789, 72855, 74095, 75329, 76472, 77281, 77984, 78943, 80171, 81310, 82260, 83714, 85223, 85358, 87107, 88276, 88956, 90774, 91251, 93085, 94096, 95758, 97035, 98393, 99595, 100810, 101721, 103627, 104224, 106207, 107270])
Z = np.array([1, 486, 968, 1445, 1971, 2498, 2982, 3570, 3997, 4589, 5161, 5658, 6161, 6569, 7168, 7726, 8314, 8718, 9210, 9416, 10220, 11126, 11784, 12314, 13140, 13730, 14526, 14937, 15661, 16207, 17068, 18043, 18592, 19358, 20327, 20692, 21140, 22146, 22796, 23560, 24204, 24868, 25068, 25562, 26456, 27059, 27679, 28318, 29312, 30079, 30590, 31327, 31869, 32028, 32952, 33586, 34599, 35903, 36991, 38013, 39095, 39688, 40568, 41688, 43061, 44160, 44848, 46252, 47146, 47656, 48345, 49694, 50556, 51687, 52155, 53504, 54972, 55870, 56435, 57217, 58379, 59562, 60475, 61568, 62894, 63917, 64865, 65994, 66869, 68000, 68753, 70438, 71581, 72448, 73317, 74494, 76046, 77235, 79143, 80355, 81428, 82519, 84106, 86384, 88018, 89561, 90397, 91243, 93397, 95121, 96790, 98115, 99064, 100344, 102048, 103853, 105321, 106639, 108067, 109612, 111013, 112538, 113242, 114994, 116327, 118265, 119742, 121309, 123123, 124515, 126117, 128154, 129885, 131732, 132667, 133823, 135566, 137828, 139977, 142455, 145235, 147416, 149867, 152032, 154152, 156106, 157884, 159963, 162025, 164416, 166712, 169519, 171685, 173079, 176201, 178542, 180236, 182895, 185095, 188483, 190660, 193191, 196192, 198607, 201095, 203746, 205984, 208818, 210894, 214517, 217030, 219635
])

W = W.astype(np.float64)
Z = Z.astype(np.float64)

lengt = len(W) + 0.0

lambda1, tau = symbols('lambda1 tau')

s = 0.0
t = 0.0
for j in range(1,len(W)):
    s = s + W[j]
    t = t + Z[j-1]

q = s/t   

def f0(a,b):
    p = 0.0
    for j in range(1,len(W)):
        p = p + Z[j]/(lambda1*(Z[j-1] - W[j]) + tau)
    return p - lengt

def f1(a,b):
    q = 0.0
    r = 0.0
    for j in range(1,len(W)):
        r = r + Z[j-1] - W[j]
        q = q + (Z[j]*(Z[j-1] - W[j]))/(lambda1*(Z[j-1] - W[j]) + tau)
    return q - r

def f2(z):
    x = z[0]
    y = z[1]
    f = np.zeros(2)
    f[0] = f0(lambda1,tau).subs(lambda1,x).subs(tau,y)
    f[1] = f1(lambda1,tau).subs(lambda1,x).subs(tau,y)
    return f

#print(f2([2.001,435.18]))
''' 
z = fsolve(f2,[1.0, 1.0])   #initial guess
a = 'q'
b = 'lambda'
c = 'tau'
print('%s        %s     %s \n%f %f %f' % (a,b,c, q, z[0], z[1]))
'''


        

